# Таблица маршрутизации Brain

Детальная таблица для определения режима работы.

---

## По типу запроса

| Ключевые слова в запросе | Режим | Workflow |
|--------------------------|-------|----------|
| "добавь фичу", "сделай X", "создай" | PLANNING | `/planning` |
| "не работает", "ошибка", "баг", "крашится" | DEBUGGING | `/debugging` |
| "проверь", "протестируй", "работает ли" | VERIFICATION | `/verification` |
| "как лучше", "что выбрать", "A или B" | REASONING | `/reasoning` |
| "почему", "объясни", "как устроено" | RESEARCH | `/research` |
| "отрефактори", "улучши код", "почисти" | REFACTORING | `/refactoring` |
| "большой проект", "много задач" | ORCHESTRATION | `/orchestration` |

---

## По состоянию проекта

| Текущее состояние | Следующий режим | Условие перехода |
|-------------------|-----------------|------------------|
| Нет плана | BRIEFING → PLANNING | Сложная задача |
| Есть план, не утверждён | PLANNING | Ждём approval |
| План утверждён | EXECUTION | Можно писать код |
| Код написан | VERIFICATION | Нужна проверка |
| Проверка провалена | DEBUGGING или EXECUTION | Зависит от причины |
| Всё работает | POSTMORTEM (опционально) | Извлечь уроки |

---

## Signals для автоопределения

### → DEBUGGING

- Stack trace в сообщении
- "SyntaxError", "TypeError", "Error"
- "не запускается", "крашится"
- Пользователь показывает лог ошибки

### → PLANNING

- "Нужно добавить..."
- "Хочу чтобы..."
- "Сделай так чтобы..."
- Нет implementation_plan.md

### → EXECUTION

- implementation_plan.md существует и утверждён
- "Делай по плану"
- "Можно начинать"

### → VERIFICATION

- "Проверь работает ли"
- После серии изменений в коде
- Перед сообщением пользователю о готовности

### → REASONING

- "Как лучше сделать X?"
- "Что выбрать: A или B?"
- Несколько равноценных подходов

---

## Приоритет режимов

При конфликте (несколько режимов подходят):

1. **DEBUGGING** — если есть явная ошибка
2. **VERIFICATION** — если код только что изменён
3. **EXECUTION** — если есть утверждённый план
4. **PLANNING** — если нужны изменения без плана
5. **BRIEFING** — если задача не ясна
